/*
 * Copyright 2022 ST-Lab
 *
 * This program is free software; you can redistribute it and/or modify it under the terms of the
 * GNU General Public License version 2 as published by the Free Software Foundation.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without
 * even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * General Public License for more details.
 */

package org.urbcomp.start.db

import org.geotools.data.DataStoreFinder
import org.junit.Assert.assertEquals
import org.locationtech.geomesa.utils.io.WithClose

import java.sql.DriverManager
import java.util
import java.util.Properties

/**
  * test for Insert
  * @author  WangBohong
  * @date    2022-06-08
  */
class InsertTest extends AbstractCalciteFunctionTest {

  /**
    * test for insert
    */
  test("testInsert") {
    val statement = connect.createStatement()
    val set = statement.executeQuery("select count(1) from t_test")
    set.next()
    val valueBefore: Long = set.getObject(1).asInstanceOf[Long]
    statement.execute(
      "Insert into t_test (idx, ride_id, start_point) values (171, '05608CC867EBDF63', st_makePoint(2.1, 2))"
    )
    val set1 = statement.executeQuery("select count(1) from t_test")
    set1.next()
    val valueAfter: Long = set1.getObject(1).asInstanceOf[Long]
    assertEquals(1, valueAfter - valueBefore)
  }

  /**
    * test for trajectory insert
    */
  ignore("insert trajectory") {
    val stmt = connect.createStatement()
    val rs1 = stmt.executeQuery("select count(1) from t_trajectory_test")
    rs1.next()
    val valueBefore = rs1.getObject(1).asInstanceOf[Long]
    val rs2 = stmt.execute(
      "insert into table t_trajectory_test(id1, t1) values (3, st_traj_fromGeoJSON('{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:28:21.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99553,34.27859]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:28:24.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99552,34.27822]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:28:27.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99552,34.27786]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:28:30.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99552,34.27748]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:28:33.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99551,34.27708]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:28:36.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99551,34.27668]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:28:39.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.9955,34.27629]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:28:42.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99549,34.2759]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:28:45.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99549,34.27552]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:28:48.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99549,34.27514]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:28:51.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99549,34.27476]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:28:54.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99548,34.2744]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:28:57.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99549,34.27407]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:00.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99548,34.27375]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:03.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99548,34.27354]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:06.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99548,34.27343]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:10.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99548,34.27323]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:12.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99547,34.27303]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:15.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99547,34.27279]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:18.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99547,34.27257]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:21.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99547,34.27233]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:24.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99546,34.27206]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:27.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99547,34.27177]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:30.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99546,34.2715]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:33.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99546,34.27122]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:36.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99545,34.27093]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:39.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99545,34.27068]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:42.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99545,34.27054]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:45.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99546,34.2703]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:48.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99545,34.27007]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:51.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99546,34.2698]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:29:57.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99547,34.26946]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:01.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99546,34.26891]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:03.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99546,34.26882]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:06.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.9955,34.26832]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:09.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99551,34.26807]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:12.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.9955,34.2678]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:15.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.9955,34.26754]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:18.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.9955,34.26731]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:21.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99549,34.26714]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:24.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.9955,34.26707]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:27.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99549,34.26704]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:30.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99549,34.26691]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:33.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99549,34.26675]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:36.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99549,34.26662]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:39.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99548,34.26644]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:42.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99548,34.26623]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:45.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99548,34.26607]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:48.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99548,34.26591]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:51.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99547,34.2657]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:54.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99544,34.26549]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:30:57.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99543,34.26528]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:00.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99543,34.26506]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:03.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99542,34.26484]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:06.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99542,34.26467]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:09.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.9954,34.2645]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:12.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.9954,34.26429]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:15.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99541,34.26406]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:18.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99542,34.2638]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:21.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99542,34.26349]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:24.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99542,34.26318]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:27.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99542,34.26286]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:30.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99541,34.26256]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:40.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99541,34.2623]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:42.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99542,34.26158]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:46.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99541,34.26137]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:48.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99541,34.26125]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:51.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99541,34.26115]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:54.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99539,34.26104]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:31:57.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99539,34.26094]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:00.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.9954,34.26079]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:03.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99542,34.2606]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:06.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99543,34.2605]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:09.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99543,34.2604]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:12.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99546,34.26022]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:15.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99556,34.26005]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:18.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99564,34.25998]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:21.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99574,34.25991]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:24.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99597,34.25977]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:27.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99618,34.2596]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:30.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99634,34.25938]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:33.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99643,34.25919]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:36.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99651,34.25904]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:39.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99655,34.25891]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:42.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99657,34.25875]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:45.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99655,34.25857]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:48.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99654,34.25837]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:51.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99652,34.25826]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:54.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99647,34.25821]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:32:57.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99639,34.25818]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:00.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99624,34.25818]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:03.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99598,34.25819]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:06.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99568,34.2582]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:09.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99536,34.2582]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:12.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99502,34.2582]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:15.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99469,34.25819]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:18.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99449,34.25818]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:22.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99433,34.25818]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:24.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99414,34.25818]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:27.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99391,34.25818]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:30.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99363,34.25818]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:33.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99337,34.25817]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:36.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99312,34.25817]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:39.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99287,34.25817]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:42.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.9926,34.25816]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:45.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99245,34.25816]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:48.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.9923,34.25816]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:51.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99205,34.25815]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:54.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99171,34.25816]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:33:57.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99133,34.25815]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:34:00.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99099,34.25815]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:34:03.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99066,34.25814]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:34:06.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.99028,34.25814]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:34:09.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.98991,34.25814]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:34:12.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.98954,34.25815]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:34:16.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.98919,34.25815]}},{\"type\":\"Feature\",\"properties\":{\"time\":\"2018-10-09 07:34:18.0\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[108.98897,34.25815]}}],\"properties\":{\"oid\":\"afab91fa68cb417c2f663924a0ba1ff9\",\"tid\":\"afab91fa68cb417c2f663924a0ba1ff92018-10-09 07:28:21.0\"}}'))"
    )
    val rs3 = stmt.executeQuery("select count(1) from t_trajectory_test")
    rs3.next()
    val valueAfter = rs3.getObject(1).asInstanceOf[Long]
    assertEquals(1, valueAfter - valueBefore)
  }

}
